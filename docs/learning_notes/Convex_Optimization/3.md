
> date: 2023-01-15

## 一、凸函数定义，基础性质与例子

### （1）凸函数定义

$\textbf{Definition.}$ 函数 $f:\mathbb R^n \mapsto \mathbb R$，如果定义域 $\mathop{\text{dom}} f$ 是凸集，且对任意的 $x, y \in \mathop{\text{dom}} f$ 与任意的 $\theta \in [0, 1]$，都有
$$
f(\theta x+ (1-\theta)y) \leq \theta f(x) + (1-\theta)f(y),
$$
则我们称函数 $f$ 为 **凸函数（convex function）**。如果对任意的 $x, y \in \mathop{\text{dom}} f, \ x \neq y$，任意的 $\theta \in (0, 1)$，都有
$$
f(\theta x+ (1-\theta)y) < \theta f(x) + (1-\theta)f(y),
$$
则我们称函数 $f$ 为 **严格凸函数（strictly convex function）**。我们称函数 $f$ 为 **凹函数（concave function）**，如果 $-f$ 是凸函数。严格凹函数同理。

$\textbf{Remark.}$ 不难发现，仿射函数（包括线性函数）满足上述性质中取等的情况，因此仿射函数既是凸函数也是凹函数。反之，如果一个函数既是凸函数也是凹函数，则该函数是仿射函数。



### （2）凸函数性质，判断凸函数条件

下面我们给出一些用于判断函数凸性的性质定理。

$\textbf{Theorem 3.1.1.}$ 函数 $f: \mathbb R^n \mapsto \mathbb R$ 是凸函数，当且仅当对任意的 $x \in \mathop{\text{dom}} f$ 与任意的 $v$，函数 $g: \mathbb R \mapsto \mathbb R, \ g(t) = f(x+tv)$ 在其定义域 $\{t \ | \ x+tv \in \mathop{\text{dom}} f\}$ 上是凸函数。

这条定理非常有用，它让我们可以通过将函数限制在一条直线上，得到一个单变量一维函数，再来查看凸性。

<br>

$\textbf{Theorem 3.1.2 (first-order condition).}$ 如果函数 $f$ 是可微的（differentiable，即梯度 $\nabla f$ 对开集 $\mathop{\text{dom}} f$ 中任意点都存在），则函数 $f$ 是凸函数，当且仅当 $\mathop{\text{dom}} f$ 是凸集，且对任意的 $x, y \in \mathop{\text{dom}} f$，都有
$$
f(y) \geq f(x) + \nabla f(x)^T(y-x);
$$
函数 $f$ 是严格凸函数，当且仅当 $\mathop{\text{dom}} f$ 是凸集，且对任意的 $x, y \in \mathop{\text{dom}} f, \ x \neq y$，都有
$$
f(y) > f(x) + \nabla f(x)^T(y-x).
$$
$\textit{Proof.}$ 我们首先考虑 $n=1$ 的情况，即可微函数 $f$ 是凸函数，当且仅当对任意的 $x, y \in \mathop{\text{dom}} f$，都有 $f(y) \geq f(x) + f'(x)(y-x)$。

（$\Rightarrow$）：因为函数 $f$ 是凸函数且 $\mathop{\text{dom}} f$ 是凸集（即一个区间），则我们可以得到对任意的 $0<t\leq 1, \ x + t(y-x) \in \mathop{\text{dom}} f$，都有
$$
f(x+t(y-x)) \leq (1-t)f(x) + tf(y),
$$
左右同除 $t$，即得
$$
f(y) \geq f(x) + \frac{f(x+t(y-x)) - f(x)}{t},
$$
当 $t \rightarrow 0^+$ 时，右侧即化为 $f(x)+f'(x)(y-x)$。

（$\Leftarrow$）：对任意的 $x\neq y, \ \theta \in [0,1]$，取 $z = \theta x + (1-\theta)y$，则我们应有
$$
f(x) \geq f(z) + f'(z)(x-z), \quad f(y) \geq f(z) + f'(z)(y-z),
$$
将第一个不等式乘以 $\theta$，再将第二个不等式乘以 $1-\theta$，两者相加，即得到
$$
\theta f(x)+(1-\theta)f(y) \geq f(z)+f'(z)(\theta x + (1-\theta)y - z) = f(z),
$$
即函数 $f$ 是凸函数。

下面我们证明广义情况 $n\geq 2$，取 $x, y \in \mathbb R^n, \ g(t) = f(ty+(1-t)x)$，且有 $g'(t) = \nabla f(ty+(1-t)x)^T(y-x)$。

（$\Rightarrow$）： $f$ 是凸函数，因此 $g$ 也是凸函数，我们即有 $g(1) \geq g(0) + g'(0)$，即可直接化为 $f(y) \geq f(x)+\nabla f(x)^T(y-x)$。

（$\Leftarrow$）：对任意的 $x\neq y$，如果有 $ty+(1-t)x \in \mathop{\text{dom}}f$ 和 $\tilde ty+(1-\tilde t)x \in \mathop{\text{dom}}f$，则根据已有性质得
$$
f(ty+(1-t)x) \geq f(\tilde ty+(1-\tilde t)x) + \nabla f(\tilde ty+(1-\tilde t)x)^T(y-x)(t-\tilde t),
$$
即 $g(t) \geq g(\tilde t) + g'(\tilde t)(t-\tilde t)$，我们已经在第一部分证明中得到此时 $g$ 为凸函数。

$\square$

可以看到，不等式右侧即是函数 $f$ 在点 $x$ 处附近的一阶泰勒近似，也是一个关于 $y$ 的仿射函数。上述不等式告诉我们，我们通过凸函数的局部信息（关于某个点的一阶泰勒展开），可以推断出凸函数的全局信息（函数在任意点都要大于该一阶泰勒展开）。这可能是凸函数最重要的性质特点，也是许多凸函数在凸优化问题中优良性质的来源。

$\textbf{Remark.}$ 根据上述定理，易得如果有 $\nabla f(x) = 0$，则对任意的 $y \in \mathop{\text{dom}} f$，都有 $f(y) \geq f(x)$，即 $x$ 是函数 $f(x)$ 的全局最小值点。

<br>

$\textbf{Theorem 3.1.3 (second-order condition).}$ 如果函数 $f$ 是二阶可微的（differentiable，即Hessian $\nabla^2 f$ 对开集 $\mathop{\text{dom}} f$ 中任意点都存在），则函数 $f$ 是凸函数，当且仅当 $\mathop{\text{dom}} f$ 是凸集，且对任意的 $x \in \mathop{\text{dom}} f$，其Hessian矩阵都是半正定矩阵，即有
$$
\nabla^2 f(x) \succeq 0;
$$
函数 $f$ 是严格凸函数，如果 $\mathop{\text{dom}} f$ 是凸集，且对任意的 $x \in \mathop{\text{dom}} f$，其Hessian矩阵都是正定矩阵，即有
$$
\nabla^2 f(x) \succ 0.
$$
$\textit{Proof.}$ 与一阶条件的证明类似，我们首先考虑 $n=1$ 的情况，即二阶可微函数 $f$ 是凸函数，当且仅当对任意的 $x\in \mathop{\text{dom}} f$，都有 $f''(x)\geq 0$。

（$\Rightarrow$）：因为函数 $f$ 是凸函数，我们可以得到对任意的 $t,y, \ x + t(y-x) \in \mathop{\text{dom}} f$，都有
$$
f(x+td) \geq f(x) + f'(x)td ,
$$
其中 $d=y-x$。对函数 $f$ 做带Peano余项的泰勒展开，得到
$$
f(x+td) = f(x)+f'(x)td+\frac{1}{2}f''(x)t^2d^2+o(t^2d^2),
$$
我们即可推得
$$
\frac{1}{2}f''(x)d^2+\frac{o(t^2d^2)}{t^2} \geq 0,
$$
当 $t \rightarrow 0$ 时，不等式即化为 $f''(x)\geq 0$。

（$\Leftarrow$）：对函数做带Lagrange余项的泰勒展开，即得到
$$
f(y) = f(x)+f'(x)d+\frac{1}{2}f''(x+td)d^2,
$$
其中 $t\in(0,1)$。由于 $f'' \geq 0$，我们即得到 $f(y) \geq f(x)+f'(x)d$，由一阶条件得函数 $f$ 为凸函数。

下面我们证明广义情况 $n\geq 2$，取 $x, y \in \mathbb R^n, \ g(t) = f(x+td)$，则有 $g'(t) = \nabla f(x+td)^Td, \ g''(t)=d^T\nabla^2 f(x+td)d$。

（$\Rightarrow$）： $f$ 是凸函数，因此 $g$ 也是凸函数，我们即有 $g''(t)= d^T\nabla^2 f(x+td)d \geq 0$ 对任意的 $t, d$ 均成立，因此有 $\nabla^2 f(x) \succeq 0$ 对任意的 $x$ 均成立。

（$\Leftarrow$）：由Hessian矩阵正定即得 $g'' \geq 0$；对任意的 $t, \tilde t$，对函数 $g$ 做带Lagrange余项的泰勒展开，即有
$$
g(t) = g(\tilde t)+g'(\tilde t)(t-\tilde t)+\frac{1}{2}g''(\theta t+(1-\theta)\tilde t)(t-\tilde t)^2,
$$
其中 $\theta \in (0,1)$，即可推得 $g(t) \geq g(\tilde t) + g'(\tilde t)(t-\tilde t)$，由一阶条件得到此时 $g$ 为凸函数。

$\square$

对单变量一维函数而言，上述二阶条件即为 $f''(x)\geq 0$，代表导数 $f'(x)$ 是非递减的。

$\textbf{Remark.}$ 注意在二阶条件定理中，严格凸函数的判别是单向的，反向并不成立。如，$x^4$ 是严格凸函数（容易通过定义验证），但其二阶导数并不处处严格大于 $0$。

$\textbf{Example 3.2.}$ 考虑二阶函数 $f:\mathbb R^n \mapsto \mathbb R, \ \mathop{\text{dom}} f = \mathbb R^n, \ f(x) = (1/2)x^TPx+q^Tx+r$，其中 $P \in \mathbb S^n, q\in \mathbb R^n, r\in \mathbb R$。由于对任意的 $x$ 都有 $\nabla^2 f = P$，因此，$f$ 是凸函数当且仅当 $P \succeq 0$，$f$ 是严格凸函数当且仅当 $P \succ 0$。

$\textbf{Example.}$ 函数 $f(x) = 1/x^2$，定义域为 $\{x\in \mathbb R \ | \ x \neq 0\}$。虽然 $f$ 对任意的 $x$ 都有 $f''(x)\geq 0$，但其定义域并非凸集，因此 $f$ 不是凸函数。



### （3）一些凸函数的例子

下面我们给出一些凸函数的例子，这些凸函数均可通过上述性质定理或定义来得以验证。我们在上面已经指出仿射函数（包括线性函数）既是凸函数，也是凹函数。



$\textbf{Example.}$ 以下函数均为 $\mathbb R$ 上的凸函数（或凹函数）：

- 指数函数：$e^{ax}$，对任意的 $a\in \mathbb R$；
- 幂函数：$x^a$ 在 $\mathbb R_{++}$ 上是凸函数，当 $a\leq 0$ 或 $a\geq1$；如果 $0\leq a\leq1$ 则为凹函数；
- 绝对值幂函数（powers of absolute value）：$|x|^p$，当 $p\geq1$；
- 对数函数：$\log x$ 在 $\mathbb R_{++}$ 上是凹函数，因为 $f''(x) = -1/x^2 \leq 0$；
- 负熵（negative entropy）：$x\log x$ 在 $\mathbb R_{++}$ 上是凸函数。

<br>

$\textbf{Example.}$ 以下函数均为 $\mathbb R^n$ 上的凸函数（或凹函数）：

- 所有范数 $\|\cdot\|$ 均为凸函数，因为范数根据定义满足 $\|\theta x+(1-\theta)y\| \leq \theta\|x\|+(1-\theta)\|y\|$；

  （补充：$\|x\|_p=(\sum_i|x_i|)^{1/p}, \ p\geq 1$；$\|x\|_\infty=\max_i|x_i|$）

- 最大值函数：$f(x) = \max\{x_1, \cdots, x_n\}$；

- Quadratic-over-linear function：$f(x, y)=x^2/y$，其中 $\mathop{\text{dom}}f=\mathbb R \times \mathbb R_{++}=\{(x,y) \in \mathbb R^2 \ | \ y>0 \}$；

  $\textit{Proof.}$ 

- Log-sum-exp：$f(x) = \log(e^{x_1}+\cdots+e^{x_n})$，该函数满足
  $$
  \max\{x_1, \cdots, x_n\} \leq f(x) \leq \max\{x_1, \cdots, x_n\}+\log n,
  $$
  因此可被看做为最大值函数的可微近似；

- 几何平均数：$f(x)=(\prod_i x_i)^{1/n}$ 在 $\mathbb R_{++}^n$ 上是凹函数；

<br>

$\textbf{Example.}$ 以下函数均为 $\mathbb R^{m\times n}$ 上的凸函数（或凹函数）：

- 仿射函数：$f(X) = \mathop{\text{tr}}(A^TX)+b = \sum_{i}\sum_jA_{ij}X_{ij}+b$；
- 谱范数：$\|X\|_2=\sigma_{\max}(X)=(\lambda_{\max}(X^TX))^{1/2}$，即矩阵最大的奇异值；

- Log-determinant：$\log \det X$ 在 $\mathbb S_{++}^n$ 上是凹函数。



